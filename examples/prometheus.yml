global:
  scrape_interval: 15s
  evaluation_interval: 15s
  external_labels:
    cluster: 'radius-ha'
    environment: 'docker-compose'

scrape_configs:
  # RADIUS Server Metrics
  - job_name: 'radius-servers'
    dns_sd_configs:
      - names:
          - 'radius-server'
        type: 'A'
        port: 3812
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance

  # Static configuration fallback
  - job_name: 'radius-static'
    static_configs:
      - targets:
          - 'radius-server-1:3812'
          - 'radius-server-2:3812'
          - 'radius-server-3:3812'
    scrape_interval: 15s
    scrape_timeout: 10s

  # HAProxy Stats
  - job_name: 'haproxy'
    static_configs:
      - targets:
          - 'haproxy:8080'
    metrics_path: '/stats'
    scrape_interval: 30s

  # Valkey Stats (if enabled)
  - job_name: 'valkey'
    static_configs:
      - targets:
          - 'valkey:6379'
    scrape_interval: 30s

# Alert rules
rule_files:
  # - 'alerts.yml'

# Alertmanager configuration
# alerting:
#   alertmanagers:
#     - static_configs:
#         - targets:
#             - 'alertmanager:9093'
